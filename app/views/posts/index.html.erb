<h1 class="text-center"> <%= "Forum: #{@forum.name} #{@forum.group}"%></h1>

<%= link_to "Back", city_forums_path(@forum.city), class: "btn btn-info"%>
<div class="forums">
  <section class="forum-nav">
    <header>Forums</header>
    <%= link_to "#lis.general", "#", class: "forum-btn" %>
    <%= link_to "gen-chat", city_chatroom_path(@forum.city, @chatroom), class: "chatroom-btn" %>
    <%= link_to "#lis.social", "#", class: "forum-btn" %>
    <%= link_to "prof-chat", city_chatroom_path(@forum.city, @chatroom), class: "chatroom-btn" %>
    <%= link_to "#lis.prof", "#", class: "forum-btn" %>
    <%= link_to "prof-chat", city_chatroom_path(@forum.city, @chatroom), class: "chatroom-btn" %>
    <%if @chatroom %>
      <%# link_to "Chatroom: #{@chatroom.name}", city_chatroom_path(@forum.city, @chatroom), class: "chatroom-btn"  %>
    <% end %>
  </section>

  <section class="forum-posts">
    <%= link_to "+ Create new post", "#", class: "btn btn-primary"%>
  
    <%= simple_form_for [@forum, @post],  html: { class: "new-post-form"}, remote: true do |f| %>
      <%= f.input :title, placeholder: "Title" %>
      <%= f.input :content, label: false, placeholder: "Content" %>
      <%= f.submit "Create Post" %>
    <% end %>

    <% if @forum.posts.any? %>
      <% @forum.posts.order(created_at: :DESC).each do |post| %>
        <%# Creating post with title, author, and content %>
        <article class="post-card">
          <section class="post-section" id="post-<%= post.id%>">
            <header><%= post.title %></header>
            <small> <%= "by #{post.user.username} on #{post.created_at.strftime("%B %-d, %Y %-l:%M%p")}"%></small>
            <p class="post-content"><%= post.content %></p>      
          </section>

          <section class ="comments-section">
              <%# Check to see if comments anre create comments below %>
              <% if post.comments.any? %>
                <% post.comments.order(created_at: :ASC).each do |comment| %>
                  <div class="comment" id="comment-<%= comment.id %>">
                    <p class="comment-header"><%= "#{comment.user.username} on #{comment.created_at.strftime("%B %-d, %Y %-l:%M%p")}"%></b></p>
                    <p><%= "#{comment.content}"%></p>
                  </div>
                <% end %>
              <% end %>
            <%= simple_form_for [post, @comment], remote: true do |f| %>
              <%= f.input :content, label: false, placeholder: "Commenting as #{current_user.username}", class: "test"  %>
              <%= f.submit "Send" %>
            <% end %> 
          </section>
        </article>
      <% end %>
    <% end %>
  </section>
</div>
